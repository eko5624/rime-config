schema:
  schema_id: wanxiang
  name: ä¸‡è±¡æ‹¼éŸ³
  version: "1.0"
  icon: icons/zh.ico
  ascii_icon: icons/en.ico
  full_icon: icons/full.ico
  half_icon: icons/half.ico
  author:
    - amzxyz
  description: |
    åŸºäºè¶…å¤§è§„æ¨¡è¯­æ–™çš„RIMEå¸¦è°ƒæ‹¼éŸ³æ–¹æ¡ˆ
  dependencies:
    - wubi86
    - radical_pinyin

switches:
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
    reset: 1
  - name: ascii_mode
    states: [ ä¸­, è‹± ]
    reset: 0
  - options: [ std, s2hk, s2twp ]
    states: [ é€š, æ¸¯, å° ]
    reset: 0
  - name: extend_charset # 0ä¸ºCJKåŸºæœ¬å­—ç¬¦é›†+æ‰©å±•AåŒºï¼Œ1ä¸ºCJKå…¨å­—ç¬¦é›†
    states: [ å¸¸, æ‰© ]
    reset: 1
  - name: charset_comment
    states: [ ç åŒºå…³, ç åŒºå¼€ ]
    reset: 1
  - name: full_shape
    states: [ åŠ, å…¨ ]
    reset: 0
  - name: ascii_punct  # ä¸­è‹±æ ‡ç‚¹
    states: [ "ã€‚ï¼Œ", "ï¼ï¼Œ" ]
    reset: 0
    
engine:
  processors:
    - lua_processor@*select_character
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - affix_segmentor@radical_lookup
    - affix_segmentor@wubi86_lookup
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - history_translator@history
    - lua_translator@time_date
    - lua_translator@*calculator
    - lua_translator@*number                    # æ•°å­—é‡‘é¢å¤§å†™
    - lua_translator@*force_gc                  # æš´åŠ› GC é™ä½å†…å­˜
    - lua_translator@*unicode                   # Unicode
    - table_translator@custom_phrase            # è‡ªå®šä¹‰çŸ­è¯­ custom_phrase.txt
    - table_translator@chengyu                  # ç®€ç æˆè¯­
    - reverse_lookup_translator@radical_lookup
    - reverse_lookup_translator@wubi86_lookup
    - script_translator
  filters:
    - simplifier
    - simplifier@s2hk
    - simplifier@s2tw
    #- simplifier@transcription_cc
    - simplifier@emoji                          # Emoji OpenCC
    - lua_filter@*charset*filter                # CJKå­—ç¬¦é›†è¿‡æ»¤
    - lua_filter@*charset*comment_hint          # CJKå­—ç¬¦é›†ç åŒºæç¤º
    - uniquifier                                # å»é‡

predictor:
  db: wanxiang-lts-zh-predict.db
# æ¯æ¬¡æœ€å¤§é¢„æµ‹å€™é€‰æ•°
# é»˜è®¤ä¸º 0ï¼Œè¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰å€™é€‰æ•°
# æ‚¨å¯ä»¥å°†å…¶è®¾ç½®ä¸ºä¸ page_size ç›¸åŒï¼Œè¿™æ · period å°±ä¸ä¼šè§¦å‘ä¸‹ä¸€é¡µ
  max_candidates: 8
# æœ€å¤§è¿ç»­é¢„æµ‹æ¬¡æ•°
# é»˜è®¤ä¸º 0ï¼Œè¡¨ç¤ºæ— é™åˆ¶
  max_iterations: 1

# ç®€ç¹è½¬æ¢
# transcription_cc:
  # option_name: transcription
  # opencc_config: s2t.json             # ç®€ -> ç¹
  # opencc_config: s2hk.json              # ç®€ -> é¦™æ¸¯
  # opencc_config: t2s.json             # ç¹ -> ç®€
  # opencc_config: t2tw.json            # ç¹ -> å°æ¹¾
  # opencc_config: t2hk.json            # ç¹ -> é¦™æ¸¯
  # opencc_config: s2tw.json            # ç°¡ -> è‡ºç£æ¨™æº–
  # opencc_config: s2twp.json           # ç°¡ -> è‡ºç£ç‰‡èª
  # tips: none                            # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  # tags: [abc]                           # é™åˆ¶åœ¨å¯¹åº” tag åªåœ¨äº”ç¬”è¾“å…¥æ—¶å¯ç”¨ç®€ç¹è½¬æ¢

s2hk:
  opencc_config: s2hk.json
  option_name: s2hk
  tags: [abc]                           # é™åˆ¶åœ¨å¯¹åº” tag åæŸ¥æ—¶ä¸è¿›è¡Œç®€ç¹è½¬æ¢
  tips: all

s2tw:
  opencc_config: s2twp.json
  option_name: s2twp
  tags: [abc]                           # é™åˆ¶åœ¨å¯¹åº” tag åæŸ¥æ—¶ä¸è¿›è¡Œç®€ç¹è½¬æ¢
  tips: all

# è‡ªå®šä¹‰çŸ­è¯­
custom_phrase:
  dictionary: ""
  user_dict: custom_phrase  # éœ€è¦æ‰‹åŠ¨åˆ›å»º custom_phrase.txt æ–‡ä»¶
  db_class: stabledb
  enable_completion: false # è¡¥å…¨æç¤º
  enable_sentence: false   # ç¦æ­¢é€ å¥
  initial_quality: 99

# ç®€ç è¯åº“å¯¼å…¥ä½äºjm_dictså¾—txtæ–‡ä»¶è¯åº“
chengyu:
  dictionary: ""
  user_dict: jm_dicts/chengyu
  db_class: stabledb
  enable_sentence: false
  enable_completion: false
  initial_quality: 100 #æœ¬è¡¨è¯å’Œç³»ç»Ÿè¯é‡ç å±…å

emoji:
  option_name: emoji
  opencc_config: emoji.json
  inherit_comment: false                # åœ¨ corrector.lua åŠåæŸ¥ä¸­ï¼Œemoji è¿”å›ç©ºæ³¨é‡Š

history:
  input: z
  size: 1
  initial_quality: 1

speller:
  # å¦‚æœä¸æƒ³è®©ä»€ä¹ˆæ ‡ç‚¹ç›´æ¥ä¸Šå±ï¼Œå¯ä»¥åŠ åœ¨ alphabetï¼Œæˆ–è€…ç¼–è¾‘æ ‡ç‚¹ç¬¦å·ä¸ºä¸¤ä¸ªåŠä»¥ä¸Šçš„æ˜ å°„
  alphabet: 'zyxwvutsrqponmlkjihgfedcba-;/<,>\'
  # initials å®šä¹‰ä»…ä½œä¸ºå§‹ç çš„æŒ‰é”®ï¼Œæ’é™¤ ` è®©å•ä¸ªçš„ ` å¯ä»¥ç›´æ¥ä¸Šå±
  initials: zyxwvutsrqponmlkjihgfedcba
  delimiter: " '"  # ç¬¬ä¸€ä½<ç©ºæ ¼>æ˜¯æ‹¼éŸ³ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼›ç¬¬äºŒä½<'>è¡¨ç¤ºå¯ä»¥æ‰‹åŠ¨è¾“å…¥å•å¼•å·æ¥åˆ†å‰²æ‹¼éŸ³ã€‚
  # æ‹¼å†™åŒ¹é…
  algebra:
    - xform/Å„/Ã©n/ 
    - xform/Åˆ/Ä›n/ 
    - xform/Ç¹/Ä›n/ 
    - xform/^ng$/eng/
    - xform/Å„g/Ã©ng/
    - xform/Åˆg/Ä›ng/
    - xform/á¹…g/Ã¨ng/
    - xform/^([a-zA-Z]+)$/$1/
    - xform/^(.*)Ä(.*)$/$1a$2â‘ /
    - xform/^(.*)Ã¡(.*)$/$1a$2â‘¡/
    - xform/^(.*)Ç(.*)$/$1a$2â‘¢/
    - xform/^(.*)Ã (.*)$/$1a$2â‘£/
    - xform/^(.*)Å(.*)$/$1o$2â‘ /
    - xform/^(.*)Ã³(.*)$/$1o$2â‘¡/
    - xform/^(.*)Ç’(.*)$/$1o$2â‘¢/
    - xform/^(.*)Ã²(.*)$/$1o$2â‘£/
    - xform/^(.*)Ä“(.*)$/$1e$2â‘ /
    - xform/^(.*)Ã©(.*)$/$1e$2â‘¡/
    - xform/^(.*)Ä›(.*)$/$1e$2â‘¢/
    - xform/^(.*)Ã¨(.*)$/$1e$2â‘£/
    - xform/^(.*)Ä«(.*)$/$1i$2â‘ /
    - xform/^(.*)Ã­(.*)$/$1i$2â‘¡/
    - xform/^(.*)Ç(.*)$/$1i$2â‘¢/
    - xform/^(.*)Ã¬(.*)$/$1i$2â‘£/
    - xform/^(.*)Å«(.*)$/$1u$2â‘ /
    - xform/^(.*)Ãº(.*)$/$1u$2â‘¡/
    - xform/^(.*)Ç”(.*)$/$1u$2â‘¢/
    - xform/^(.*)Ã¹(.*)$/$1u$2â‘£/
    - xform/^(.*)Ç–(.*)$/$1v$2â‘ /
    - xform/^(.*)Ç˜(.*)$/$1v$2â‘¡/
    - xform/^(.*)Çš(.*)$/$1v$2â‘¢/
    - xform/^(.*)Çœ(.*)$/$1v$2â‘£/
    - xform/^(.*)Ã¼(.*)$/$1v$2/
    - xlit/â‘ â‘¡â‘¢â‘£/1234
    ### ç®€æ‹¼
    - abbrev/^([a-z]).+$/$1/
    - abbrev/^([zcs]h).+$/$1/
    ### è‡ªåŠ¨çº é”™
    - derive/^([nl])ve/$1ue/
    - derive/^([jqxy])u/$1v/
    - derive/([dtnlgkhrzcs])un/$1uen/
    - derive/ui/uei/
    - derive/iu/iou/
    - derive/ao/oa/
    - derive/([aeiou])ng/$1gn/
    - derive/([iu])a(o|ng?)/a$1$2/
    - derive/^([a-z]+)[1-4]$/$1/
    - derive/([dtngkhrzcs])o(u|ng)$/$1o/
    - derive/ong$/on/
    - 'erase/^.*5$/'
    - 'xlit 1234 -/<\'

translator:
  dictionary: wanxiang
  enable_completion: true                # å¯ç”¨å€™é€‰è¯è¡¥å…¨
  db_class: tabledb
  max_candidates: 10                     # è®¾ç½®æœ€å¤§å€™é€‰è¯æ•°é‡
  initial_quality: 3
  spelling_hints: 20                     # ï½å­—ä»¥å…§å€™é¸æ¨™è¨»å®Œæ•´å¸¶èª¿æ‹¼éŸ³
  enable_charset_filter: false           # å¼€å¯å­—ç¬¦é›†è¿‡æ»¤
  enable_user_dict: true                 # å¼€å¯ç”¨æˆ·è¯å…¸
  enable_encoder: true                   # å¼€å¯è‡ªåŠ¨é€ è¯
  encode_commit_history: true            # æ˜¯å¦å¯¹å·²ä¸Šå±è¯è‡ªåŠ¨æˆè¯ï¼ˆä»… table_translator æœ‰æ•ˆï¼‰
  preedit_format:
    - xform/([nl])v/$1Ã¼/
    - xform/([nl])ve/$1Ã¼e/
    - xform/([nl])ven/$1uen/
    - xform/([jqxy])v/$1u/
    - 'xform ([aeiou])(ng?|r)([-;/<,>\\]) $1$3$2'
    - 'xform ([aeo])([iuo])([-;/<,>\\]) $1$3$2'
    - 'xform a[-;] Ä'
    - 'xform a/ Ã¡'
    - 'xform a[<,] Ç'
    - 'xform a[>\\] Ã '
    - 'xform e[-;] Ä“'
    - 'xform e/ Ã©'
    - 'xform e[<,] Ä›'
    - 'xform e[>\\] Ã¨'
    - 'xform o[-;] Å'
    - 'xform o/ Ã³'
    - 'xform o[<,] Ç’'
    - 'xform o[>\\] Ã²'
    - 'xform i[-;] Ä«'
    - 'xform i/ Ã­'
    - 'xform i[<,] Ç'
    - 'xform i[>\\] Ã¬'
    - 'xform u[-;] Å«'
    - 'xform u/ Ãº'
    - 'xform u[<,] Ç”'
    - 'xform u[>\\] Ã¹'
    - 'xform Ã¼[-;] Ç–'
    - 'xform Ã¼/ Ç˜'
    - 'xform Ã¼[<,] Çš'
    - 'xform Ã¼[>\\] Çœ'
  comment_format:
    - xform ([aeiou])(ng?|r)([1234]) $1$3$2
    - xform ([aeo])([iuo])([1234]) $1$3$2
    - xform/([nljqxy])v/$1Ã¼/

wubi86_lookup:
  tag: wubi86
  dictionary: wubi86
  enable_user_dict: false
  enable_completion: true
  prefix: "`"
  tips: ã€”äº”ç¬”ã€•

radical_lookup:
  tag: radical
  dictionary: radical_pinyin
  enable_completion: false
  enable_sentence: false
  prefix: 'vv'
  tips: ã€”æ‹†å­—ã€•

reverse_lookup:
  tags: [wubi86,radical]
  overwrite_comment: true
  dictionary: wanxiang

# æ ‡ç‚¹ç¬¦å·
# punctuator ä¸‹é¢æœ‰ä¸‰ä¸ªå­é¡¹ï¼š
#   full_shape å…¨è§’æ ‡ç‚¹æ˜ å°„
#   half_shape åŠè§’æ ‡ç‚¹æ˜ å°„
#   symbols    Rime çš„é¢„è®¾é…ç½®æ˜¯ä»¥ '/' å‰ç¼€å¼€å¤´è¾“å‡ºä¸€ç³»åˆ—å­—ç¬¦ï¼Œè‡ªå®šä¹‰çš„ symbols_v.yaml ä¿®æ”¹æˆäº† 'v' å¼€å¤´ã€‚
punctuator:
  full_shape:
    __include: default:/punctuator/full_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  half_shape:
    __include: default:/punctuator/half_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  digit_separators:
    __include: default:/punctuator/digit_separators # ä» default.yaml å¯¼å…¥é…ç½®
  symbols:
    __include: symbols:/symbols              # ä» symbols.yaml å¯¼å…¥é…ç½®

key_binder:
  import_preset: default
  bindings:
    # ä¸Šä¸‹ç¿»é¡µ - =
    # - { when: has_menu, accept: minus, send: Page_Up }             # ä¸åœ°çƒæ‹¼éŸ³çš„éŸ³è°ƒ1å£° - å†²çªï¼Œæ•…æ³¨é‡Šæ‰
    # - { when: has_menu, accept: equal, send: Page_Down }           # ä¸åœ°çƒæ‹¼éŸ³çš„éŸ³è°ƒ1å£° - å†²çªï¼Œæ•…æ³¨é‡Šæ‰
    
    # ä¸Šä¸‹ç¿»é¡µ tab
    - { when: has_menu, accept: Tab, send: Page_Down }
    - {send: Escape, accept: space, when: composing}
    - {send: space, accept: space, when: has_menu}
    - { when: always, select: .next, accept: Control+1 }             # åœ¨æœ€è¿‘çš„ä¸¤ä¸ªæ–¹æ¡ˆä¹‹é—´åˆ‡æ¢
    - { when: always, toggle: transcription, accept: Control+2}      # åˆ‡æ¢ç®€ç¹
    - { when: always, toggle: extend_charset, accept: Control+3 }    # åˆ‡æ¢CJKå­—ç¬¦é›†
    - { when: always, toggle: full_shape, accept: Control+4 }        # åˆ‡æ¢å…¨åŠè§’
    - { when: always, toggle: ascii_punct, accept: Control+5 }       # åˆ‡æ¢ä¸­è‹±æ ‡ç‚¹

recognizer:
  import_preset: default
  patterns:
    punct: '^/([0-9]0?|[A-Za-z]+)$'
    radical: "vv[a-z]*'?$"
    wubi86: "^`[a-z]*'?$"
    unicode: "^U[a-f0-9]+"              # è„šæœ¬å°†è‡ªåŠ¨è·å–ç¬¬ 2 ä¸ªå­—ç¬¦ U ä½œä¸ºè§¦å‘å‰ç¼€ï¼Œå“åº” lua_translator@*unicodeï¼Œè¾“å‡º Unicode å­—ç¬¦
    number: "^R[0-9]+[.]?[0-9]*"        # è„šæœ¬å°†è‡ªåŠ¨è·å–ç¬¬ 2 ä¸ªå­—ç¬¦ R ä½œä¸ºè§¦å‘å‰ç¼€ï¼Œå“åº” lua_translator@*numberï¼Œæ•°å­—é‡‘é¢å¤§å†™
    calculator: "^=.*$"                 # è®¡ç®—å™¨åŠŸèƒ½å¼•å¯¼

#è¯­è¨€æ¨¡å‹
__include: octagram   #å¯ç”¨è¯­è¨€æ¨¡å‹
octagram:
  __patch:
    grammar:
      language: wanxiang-lts-zh-hans
      collocation_max_length: 8         #å‘½ä¸­çš„æœ€é•¿è¯ç»„
      collocation_min_length: 2         #å‘½ä¸­çš„æœ€çŸ­è¯ç»„ï¼Œæ­é…è¯é¢‘å¥å…¨çš„è¯åº“æ—¶å€™åº”å½“æœ€å°å€¼è®¾ä¸º3é¿å¼€2å­—é«˜é¢‘è¯
      collocation_penalty: -12          #é»˜è®¤-12 å¯¹å¸¸è§æ­é…è¯ç»„æ–½åŠ çš„æƒ©ç½šå€¼ã€‚è¾ƒé«˜çš„è´Ÿå€¼ä¼šé™ä½è¿™äº›æ­é…è¢«é€‰ä¸­çš„æ¦‚ç‡ï¼Œé˜²æ­¢è¿‡äºé¢‘ç¹åœ°å‡ºç°æŸäº›å›ºå®šæ­é…ã€‚
      non_collocation_penalty: -12      #é»˜è®¤-12 å¯¹éæ­é…è¯ç»„æ–½åŠ çš„æƒ©ç½šå€¼ã€‚è¾ƒé«˜çš„è´Ÿå€¼ä¼šé™ä½éæ­é…è¯ç»„è¢«é€‰ä¸­çš„æ¦‚ç‡ï¼Œé¿å…ä¸åˆé€»è¾‘æˆ–ä¸å¸¸è§çš„è¯ç»„ç»„åˆã€‚
      weak_collocation_penalty: -24     #é»˜è®¤-24 å¯¹å¼±æ­é…è¯ç»„æ–½åŠ çš„æƒ©ç½šå€¼ã€‚ä¿æŒé»˜è®¤å€¼é€šå¸¸æ˜¯ä¸ºäº†æœ‰æ•ˆè¿‡æ»¤æ‰ä¸å¤ªå¸¸è§ä½†ä»ç„¶åˆç†çš„è¯ç»„ç»„åˆã€‚
      rear_penalty: -18                #é»˜è®¤-18 å¯¹è¯ç»„ä¸­åç»­è¯è¯­çš„ä½ç½®æ–½åŠ çš„æƒ©ç½šå€¼ã€‚è¾ƒé«˜çš„è´Ÿå€¼ä¼šé™ä½æŸäº›è¯è¯­åœ¨å¥å­åéƒ¨å‡ºç°çš„æ¦‚ç‡ï¼Œé˜²æ­¢å¥å­ç»“æ„ä¸è‡ªç„¶ã€‚
    translator/contextual_suggestions: false
    translator/max_homophones: 5
    translator/max_homographs: 5

